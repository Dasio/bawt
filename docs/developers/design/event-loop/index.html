<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.50-DEV" />
    <meta name="description" content="The event loop is designed to keep Bawt&#39;s internal state in line as well as pass messages to listeners.">


    <link rel="shortcut icon" href="/bawt/images/favicon.png" type="image/x-icon" />
<link rel="icon" href="/bawt/images/favicon.png" type="image/x-icon" />
    <title>Event Loop :: Documentation for Hugo Learn Theme</title>

    
    <link href="/bawt/css/nucleus.css?1565147846" rel="stylesheet">
    <link href="/bawt/css/fontawesome-all.min.css?1565147846" rel="stylesheet">
    <link href="/bawt/css/hybrid.css?1565147846" rel="stylesheet">
    <link href="/bawt/css/featherlight.min.css?1565147846" rel="stylesheet">
    <link href="/bawt/css/perfect-scrollbar.min.css?1565147846" rel="stylesheet">
    <link href="/bawt/css/auto-complete.css?1565147846" rel="stylesheet">
    <link href="/bawt/css/theme.css?1565147846" rel="stylesheet">
    <link href="/bawt/css/hugo-theme.css?1565147846" rel="stylesheet">
    
      <link href="/bawt/css/theme-blue.css?1565147846" rel="stylesheet">
    

    <script src="/bawt/js/jquery-2.x.min.js?1565147846"></script>

    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    
  </head>
  <body class="" data-url="/bawt/developers/design/event-loop/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a href="https://capstonelabs.github.io/bawt/"><img src="/bawt/img/bawt-white.svg" /></a>
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="text" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-close"></i></span>
</div>

<script type="text/javascript" src="/bawt/js/lunr.min.js?1565147846"></script>
<script type="text/javascript" src="/bawt/js/auto-complete.js?1565147846"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/capstonelabs.github.io\/bawt\/";
    
</script>
<script type="text/javascript" src="/bawt/js/search.js?1565147846"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/bawt/getting-started/" title="Getting Started" class="dd-item 
        
        
        
        ">
      <a href="/bawt/getting-started/">
          Getting Started
          
            <i class="fas read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/bawt/running-bawt/" title="Running bawt" class="dd-item 
        
        
        
        ">
      <a href="/bawt/running-bawt/">
          Running bawt
          
            <i class="fas read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/bawt/running-bawt/kubernetes/" title="Kubernetes" class="dd-item ">
        <a href="/bawt/running-bawt/kubernetes/">
        Kubernetes
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/bawt/running-bawt/docker/" title="Docker" class="dd-item ">
        <a href="/bawt/running-bawt/docker/">
        Docker
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/bawt/running-bawt/docker-compose/" title="Docker Compose" class="dd-item ">
        <a href="/bawt/running-bawt/docker-compose/">
        Docker Compose
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/bawt/developers/" title="Developers" class="dd-item 
        parent
        
        
        ">
      <a href="/bawt/developers/">
          Developers
          
            <i class="fas read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/bawt/developers/plugins/" title="Plugins" class="dd-item 
        
        
        
        ">
      <a href="/bawt/developers/plugins/">
          Plugins
          
            <i class="fas read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/bawt/developers/plugins/types/" title="Types" class="dd-item 
        
        
        
        ">
      <a href="/bawt/developers/plugins/types/">
          Types
          
            <i class="fas read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/bawt/developers/plugins/types/20-chat-plugins/" title="Chat Plugins" class="dd-item ">
        <a href="/bawt/developers/plugins/types/20-chat-plugins/">
        Chat Plugins
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/bawt/developers/plugins/types/30-web-plugins/" title="Web Plugins" class="dd-item ">
        <a href="/bawt/developers/plugins/types/30-web-plugins/">
        Web Plugins
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/bawt/developers/plugins/20-useful-functions/" title="Loading Config" class="dd-item ">
        <a href="/bawt/developers/plugins/20-useful-functions/">
        Loading Config
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/bawt/developers/20-datastores/" title="Datastores" class="dd-item ">
        <a href="/bawt/developers/20-datastores/">
        Datastores
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/bawt/developers/design/" title="Design" class="dd-item 
        parent
        
        
        ">
      <a href="/bawt/developers/design/">
          Design
          
            <i class="fas read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/bawt/developers/design/event-loop/" title="Event Loop" class="dd-item active">
        <a href="/bawt/developers/design/event-loop/">
        Event Loop
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/bawt/press-kit/" title="Press Kit" class="dd-item 
        
        
        
        ">
      <a href="/bawt/press-kit/">
          Press Kit
          
            <i class="fas read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/bawt/code-of-conduct/" title="Code of Conduct" class="dd-item 
        
        
        
        ">
      <a href="/bawt/code-of-conduct/">
          Code of Conduct
          
            <i class="fas read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://github.com/gopherworks/bawt"><i class='fab fa-fw fa-github'></i> Github repo</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://gohugo.io/"><i class='fas fa-fw fa-bookmark'></i> Hugo Documentation</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="http://getgrav.org">Grav</a> and <a href="http://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='Edit this page' href="https://github.com/gopherworks/bawt/tree/master/content/docs-srcdevelopers/design/event-loop.md" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text">Edit this page</span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/bawt/'>home</a> > <a href='/bawt/developers/'>Developers</a> > <a href='/bawt/developers/design/'>Design</a> > Event Loop
          
         
          
         
          
         
          
           
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#events">Events</a>
<ul>
<li><a href="#slack-messageevent">slack.MessageEvent</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            

        
        <div id="body-inner">
          
            <h1>Event Loop</h1>
          

        




<p>Core to bawt is listening to an event queue that Slack provides in the form of their Real Time Messaging API. We process this queue through an event loop, which takes it where it needs to go in bawt mainly for internal purposes.</p>

<div class="mermaid" align="left">
graph LR;
    A[slack.RTMEvent] -->|Process Event| B(handleRTMEvent)
    BB -.-> C(slack.LatencyReport)
    BB -.-> D(slack.RTMError)
    BB -.-> E(slack.ConnectedEvent)
    BB -.-> F(slack.DisconnectedEvent)
    BB -.-> G(slack.InvalidAuthEvent)
    BB -.-> H(slack.ConnectingEvent)
    BB -.-> I(slack.HelloEvent)
    BB -.-> J(slack.MessageEvent)
    BB -.-> K(slack.UserChangeEvent)
    BB -.-> L(slack.ChannelRenameEvent)
    BB -.-> M(slack.ChannelJoinedEvent)
    BB -.-> N(slack.ChannelCreatedEvent)
    BB -.-> O(slack.ChannelDeletedEvent)
    BB -.-> P(slack.ChannelArchiveEvent)
    BB -.-> Q(slack.GroupRenameEvent)
    BB -.-> R(slack.GroupJoinedEvent)
    BB -.-> S(slack.GroupCreatedEvent)
    BB -.-> T(slack.GroupCloseEvent)
    BB -.-> U(slack.GroupArchiveEvent)
    BB -.-> V(slack.GroupUnarchivedEvent)
    BB -.-> W(slack.IMCreatedEvent)
    BB -.-> X(slack.IMOpenEvent)
    BB -.-> Y(slack.IMCloseEvent)
    BB -.-> Z(slack.AckErrorEvent)
    BB -.-> AA(slack.ConnectionErrorEvent)
    B -->|First| BB{Event Loop}
    B -->|Second| CC(Send to Listeners Loop)

    click J "/bawt/developers/design/event-loop/#slack-messageevent" "Click for more details"
</div>


<div class="notices note" ><p>bawt&rsquo;s ordered execution of the event loop and the listeners is intentional. Many of bawt&rsquo;s plugins assume that bawt&rsquo;s internal state is up to date and this prevents strange race conditions.</p>
</div>


<h2 id="events">Events</h2>

<h3 id="slack-messageevent">slack.MessageEvent</h3>

<p>Notice this is not where messages are routed to listeners. The event loop is internal to bawt and only important for keeping bawt&rsquo;s core state inline.</p>

<div class="mermaid" align="left">
graph LR;
    A[slack.MessageEvent] -->|Incoming Message| B{Event Loop}
    B -->|Determine by Type| C(slack.Message)
    C -.->|Normalize Message| D("&Message{}")
    C -.-> E{ev.Msg.SubType}
    D -.-> F(message_changed)
    D -.-> G(channel_topic)
    D -.-> H(channel_purpose)
    C -.->|Verify UserMap| I(bot.Users)
    C -.->|Verify ChannelMap| J(bot.Channels)
    C -.->|Mutate Message| K(applyMentionsMe)
    C -.->|Mutate Message| L(applyFromMe)
    B -->|Dispatch to Listeners| M((Dispatcher))
    M -.-> N(Listener A)
    N -.->|Message Handler| O(bawt.Listener.filterAndDispatchMessage)
    O -.-> Q(bawt.Listener.filterMessage)
    Q -.-> R(bawt.Listener.MessageHandlerFunc)
    N -.->|Event Handler| P(bawt.Listener.EventHandlerFunc)
</div>



<footer class=" footline" >
	
</footer>


        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


        
            <a class="nav nav-prev" href="/bawt/developers/design/" title="Design"> <i class="fas fa-chevron-left"></i></a>
        
        
            <a class="nav nav-next" href="/bawt/press-kit/" title="Press Kit" style="margin-right: 0px;"><i class="fas fa-chevron-right"></i></a>
        
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/bawt/js/clipboard.min.js?1565147846"></script>
    <script src="/bawt/js/perfect-scrollbar.min.js?1565147846"></script>
    <script src="/bawt/js/perfect-scrollbar.jquery.min.js?1565147846"></script>
    <script src="/bawt/js/jquery.sticky.js?1565147846"></script>
    <script src="/bawt/js/featherlight.min.js?1565147846"></script>
    <script src="/bawt/js/html5shiv-printshiv.min.js?1565147846"></script>
    <script src="/bawt/js/highlight.pack.js?1565147846"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/bawt/js/modernizr.custom.71422.js?1565147846"></script>
    <script src="/bawt/js/learn.js?1565147846"></script>
    <script src="/bawt/js/hugo-learn.js?1565147846"></script>

    <link href="/bawt/mermaid/mermaid.css?1565147846" type="text/css" rel="stylesheet" />
    <script src="/bawt/mermaid/mermaid.js?1565147846"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

